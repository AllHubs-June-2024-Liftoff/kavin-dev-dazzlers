<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/" xmlns:sec="http://www.w3.org/1999/xhtml">
<head th:replace="fragments :: head"></head>

<body class="container bg-1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<nav th:replace="fragments :: header"></nav>

<h2 th:text="${user.username.toUpperCase()}"></h2>

<br>
<div>
    <h3>Favorite Movies</h3>
    <ul th:each="favoriteMovie : ${user.favoriteMovies}">
        <li>
            <p th:text="${favoriteMovie.name}"></p>
        </li>
    </ul>
</div>
<br>
</div>
<h3>To Watch Movies</h3>
<ul th:each="toWatchMovie : ${user.toWatchMovies}">
    <li>
        <p th:text="${toWatchMovie.name}"></p>
    </li>
</ul>
</div>


<div>
    <h3>Recent Reviews</h3>

    <p th:if="${#lists.isEmpty(user.reviewsList)}">No movies reviewed yet</p>

    <table th:unless="${#lists.isEmpty(user.reviewsList)}" class="table table-responsive">
<!--    <table th:unless="${#lists.isEmpty(user.reviewsList)}" class="table table-borderless">-->

<!--        <li th:each="i : ${#numbers.sequence(user.reviewsList.size() - 1, 0, -1)}">-->
<!--            <h4 type="text" th:text="${user.reviewsList[i].movie.getTitle()}"></h4>-->
<!--        </li>-->

        <tr th:each="i : ${#numbers.sequence(user.reviewsList.size() - 1, 0, -1)}">


            <td style="width:15%"><img class="img-poster" th:src="${user.reviewsList[i].movie.poster}" alt="poster"></td>

            <td>
                <h3> <a th:href="@{'search/movie-view/' + ${user.reviewsList[i].movie.getApiID()}}" style="font-weight: bold;" th:text="${user.reviewsList[i].movie.getTitle()}"></a></h3>
                    <span th:each="j:${#numbers.sequence(1, 5)}">
                        <span th:if="${user.reviewsList[i].star_rating >=j }"  class="fa fa-star star-checked"></span>
                        <span th:unless="${user.reviewsList[i].star_rating >=j }"  class="fa fa-star"></span>
                    </span>

                <p th:text="${user.reviewsList[i].review_text}"></p>

                <p th:unless="${selfProfile =='false'}">

                    <!--                <a th:href="@{/delete_review(reviewId=${review.id})}"-->
                    <!--                   th:data-confirm-delete="|Are you sure you want to delete review for: ${review.movie.name}?|"-->
                    <!--                   onclick="return confirm(this.getAttribute('data-confirm-delete'))" style="color:red;">Delete</a>-->

                    <form th:unless="${selfProfile =='false'}" th:action="@{/delete_review(reviewId=${user.reviewsList[i].id})}" method="post">
                        <button type="submit" class="btn btn-link" style="color:red;"
                                th:data-confirm-delete="|Are you sure you want to delete review for: ${user.reviewsList[i].movie.name}?|"
                                onclick="return confirm(this.getAttribute('data-confirm-delete'))"
                        >Delete</button>
                    </form>

                </p>
<!--                <hr class="hr-light"/>-->
            </td>
        </tr>



<!--        Replacing old display -->
<!--        <thead>-->
<!--        <tr>-->
<!--            <th style="width:25%">Movie Name</th>-->
<!--            <th style="width:50%">Review</th>-->
<!--            <th style="width:20%">Star Rating</th>-->
<!--            <th style="width:5%" th:unless="${selfProfile =='false'}">-->

<!--            </th>-->
<!--        </tr>-->
<!--        </thead>-->

<!--        <tr th:each="review : ${user.reviewsList}">-->

<!--            <td><a th:href="@{'search/movie-view/' + ${review.movie.getApiID()}}" th:text="${review.movie.getTitle()}"></a></td>-->
<!--&lt;!&ndash;            <td th:text="${review.movie}"></td>&ndash;&gt;-->
<!--            <td th:text="${review.review_text}"></td>-->
<!--&lt;!&ndash;            <td th:text="${review.star_rating}"></td>&ndash;&gt;-->
<!--            <td >-->
<!--                <span th:each="i:${#numbers.sequence(1, 5)}">-->
<!--                    <span th:if="${review.star_rating >=i }"  class="fa fa-star star-checked"></span>-->
<!--                    <span th:unless="${review.star_rating >=i }"  class="fa fa-star"></span>-->
<!--                </span>-->

<!--&lt;!&ndash;                <span th:if="${review.star_rating >=1 }"  class="fa fa-star checked"></span>&ndash;&gt;-->
<!--&lt;!&ndash;                <span th:unless="${review.star_rating >=1 }"  class="fa fa-star"></span>&ndash;&gt;-->
<!--&lt;!&ndash;                <span th:if="${review.star_rating >=2 }"  class="fa fa-star checked"></span>&ndash;&gt;-->
<!--&lt;!&ndash;                <span th:unless="${review.star_rating >=2 }"  class="fa fa-star"></span>&ndash;&gt;-->
<!--&lt;!&ndash;                <span th:if="${review.star_rating >=3 }"  class="fa fa-star checked"></span>&ndash;&gt;-->
<!--&lt;!&ndash;                <span th:unless="${review.star_rating >=3 }"  class="fa fa-star"></span>&ndash;&gt;-->
<!--&lt;!&ndash;                <span th:if="${review.star_rating >=4 }"  class="fa fa-star checked"></span>&ndash;&gt;-->
<!--&lt;!&ndash;                <span th:unless="${review.star_rating >=4 }"  class="fa fa-star"></span>&ndash;&gt;-->
<!--&lt;!&ndash;                <span th:if="${review.star_rating >=5 }"  class="fa fa-star checked"></span>&ndash;&gt;-->
<!--&lt;!&ndash;                <span th:unless="${review.star_rating >=5 }"  class="fa fa-star"></span>&ndash;&gt;-->
<!--            </td>-->
<!--            <td th:unless="${selfProfile =='false'}">-->

<!--&lt;!&ndash;                <a th:href="@{/delete_review(reviewId=${review.id})}"&ndash;&gt;-->
<!--&lt;!&ndash;                   th:data-confirm-delete="|Are you sure you want to delete review for: ${review.movie.name}?|"&ndash;&gt;-->
<!--&lt;!&ndash;                   onclick="return confirm(this.getAttribute('data-confirm-delete'))" style="color:red;">Delete</a>&ndash;&gt;-->

<!--                <form th:action="@{/delete_review(reviewId=${review.id})}" method="post">-->
<!--                     <button type="submit" class="btn btn-link" style="color:red;"-->
<!--                             th:data-confirm-delete="|Are you sure you want to delete review for: ${review.movie.name}?|"-->
<!--                             onclick="return confirm(this.getAttribute('data-confirm-delete'))"-->
<!--                     >Delete</button>-->
<!--                </form>-->

<!--            </td>-->
<!--        </tr>-->

        <!--        Replacing old display -->
    </table>


</div>

</body>
<style>
    .star-checked {
      color: orange;
    }

    .hr-light { background-color: #404040; height: 1px; border: 0; }

    .img-poster {
  border: 1px solid #ddd;
  border-radius: 4px;
  padding: 5px;
  width: 100px;
}


</style>
</html>
